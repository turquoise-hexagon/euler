(define (f n)
  (+ (* 1/216 (expt n 4))
     (*  1/12 (expt n 3))
     (* 37/72 (expt n 2))
     (* (case (modulo n 3)
          ((0)     5/4)
          ((1) 139/108)
          ((2) 131/108))
        n)
     (* (case (modulo n 3)
          ((0)    1)
          ((1) 10/9)
          ((2)  7/9))
        1)))

(define (solve n)
  (do ((i 3 (+ i 1))
       (acc 0 (+ acc (f (- i 3)))))
    ((> i n) acc)))

(let ((_ (solve 12345)))
  (print _) (assert (= _ 265695031399260211)))
